function sol = lbs_odes()

tfinal = 500; % Final time for simulation
species = {'sp_1','sp_2','sp_3','sp_4','sp_5','sp_6','sp_7','sp_8','sp_9','sp_10','sp_11','sp_12','sp_13','sp_14','sp_15','sp_16','sp_17','sp_18','sp_19','sp_20','sp_21','sp_22','sp_23','sp_24','sp_25','sp_26','sp_27','sp_28','sp_29','sp_30','sp_31','sp_32','sp_33','sp_34','sp_35','sp_36','sp_37','sp_38','sp_39','sp_40','sp_41','sp_42','sp_43','sp_44','sp_45','sp_46','sp_47','sp_48','sp_49','sp_50','sp_51','sp_52','sp_53','sp_54','sp_55','sp_56','sp_57','sp_58','sp_59','sp_60','sp_61','sp_62','sp_63','sp_64','sp_65','sp_66','sp_67','sp_68','sp_69','sp_70','sp_71','sp_72','sp_73','sp_74','sp_75','sp_76'}; % The list of all species
n = length(species);

% Assign initial conditions
x0 = zeros(n,1);
x0(2) = 100;
x0(8) = 100;
x0(13) = 100;
x0(17) = 100;
x0(23) = 100;
x0(27) = 100;
x0(35) = 100;
x0(38) = 100;
x0(44) = 100;
x0(51) = 100;
x0(54) = 100;
x0(59) = 100;
x0(62) = 100;
x0(69) = 100;
x0(72) = 100;

% Solve the ODEs
[t,x] = ode15s(@compute_odes,[0 tfinal],x0);

% Write out a solution structure to be returned by the function
sol.t = t;
for i = 1:n
  sol.(species{i}) = x(:,i);
end

% Produce a plot
figure;
plot(t, x)
legend('GX0', 'X0', 'GX0-X0', 'GX1', 'X1', 'GX1-X1', 'GY0', 'Y0', 'GY0-Y0', 'GY1', 'Y1', 'GY1-Y1', 'GY_1_0-Y_1_0-Y_1__0', 'Y0-GY_1_0', 'Y_1_0', 'Y_1__0', 'GY_2_0-Y_2_0', 'Y_1__0-GY_2_0', 'Y_2_0', 'GY_1_0', 'GY_1_0-Y_1_0', 'GY_2_0', 'GY_1_1-Y_1_1-Y_1__1', 'Y1-GY_1_1', 'Y_1_1', 'Y_1__1', 'GY_2_1-Y_2_1', 'Y_1__1-GY_2_1', 'Y_2_1', 'GY_1_1', 'GY_1_1-Y_1_1', 'GY_2_1', 'GI0', 'I0', 'GI0-I0', 'GI1', 'I1', 'GI1-I1', 'X0-Y_1_0-GI0', 'X0-Y_1_1-GI0', 'X1-Y_1_0-GI0', 'X1-Y_1_1-GI1', 'GZ0', 'Z0', 'GZ0-Z0', 'GZ1', 'Z1', 'GZ1-Z1', 'GJ0', 'J0', 'GJ0-J0', 'GJ1', 'J1', 'GJ1-J1', 'Z0-GJ1', 'Z1-GJ0', 'GK0', 'K0', 'GK0-K0', 'GK1', 'K1', 'GK1-K1', 'J0-Y_2_0-GK0', 'J0-Y_2_1-GK0', 'J1-Y_2_0-GK0', 'J1-Y_2_1-GK1', 'GF0', 'F0', 'GF0-F0', 'GF1', 'F1', 'GF1-F1', 'I0-K0-GF0', 'I0-K1-GF1', 'I1-K0-GF1', 'I1-K1-GF1')

return
endfunction

%%%

function dxdt = compute_t_re(x,t,kfit)

% Assign derivatives
dx = zeros(76,1);


% Define reaction propensities
r_0 = 0.001*x(1)*x(2);
r_1 = 0.001*x(4)*x(5);
r_2 = 0.001*x(7)*x(8);
r_3 = 0.001*x(10)*x(11);
r_4 = 1*x(8)*x(13);
r_5 = 1*x(16)*x(17);
r_6 = 1*x(7)*x(14);
r_7 = 1*x(21)*x(18);
r_8 = 1*x(11)*x(23);
r_9 = 1*x(26)*x(27);
r_10 = 1*x(10)*x(24);
r_11 = 1*x(31)*x(28);
r_12 = 0.001*x(33)*x(34);
r_13 = 0.001*x(36)*x(37);
r_14 = 3E-05*x(2)*x(15)*x(35);
r_15 = 0.001*x(1)*x(39);
r_16 = 0.001*x(20)*x(39);
r_17 = 3E-05*x(2)*x(25)*x(35);
r_18 = 0.001*x(1)*x(40);
r_19 = 0.001*x(30)*x(40);
r_20 = 3E-05*x(5)*x(15)*x(35);
r_21 = 0.001*x(4)*x(41);
r_22 = 0.001*x(20)*x(41);
r_23 = 3E-05*x(5)*x(25)*x(38);
r_24 = 0.001*x(4)*x(42);
r_25 = 0.001*x(30)*x(42);
r_26 = 0.001*x(43)*x(44);
r_27 = 0.001*x(46)*x(47);
r_28 = 0.001*x(49)*x(50);
r_29 = 0.001*x(52)*x(53);
r_30 = 0.001*x(44)*x(54);
r_31 = 0.001*x(43)*x(55);
r_32 = 0.001*x(47)*x(51);
r_33 = 0.001*x(46)*x(56);
r_34 = 0.001*x(57)*x(58);
r_35 = 0.001*x(60)*x(61);
r_36 = 3E-05*x(50)*x(19)*x(59);
r_37 = 0.001*x(49)*x(63);
r_38 = 0.001*x(22)*x(63);
r_39 = 3E-05*x(50)*x(29)*x(59);
r_40 = 0.001*x(49)*x(64);
r_41 = 0.001*x(32)*x(64);
r_42 = 3E-05*x(53)*x(19)*x(59);
r_43 = 0.001*x(52)*x(65);
r_44 = 0.001*x(22)*x(65);
r_45 = 3E-05*x(53)*x(29)*x(62);
r_46 = 0.001*x(52)*x(66);
r_47 = 0.001*x(32)*x(66);
r_48 = 0.001*x(67)*x(68);
r_49 = 0.001*x(70)*x(71);
r_50 = 3E-05*x(34)*x(58)*x(69);
r_51 = 0.001*x(33)*x(73);
r_52 = 0.001*x(57)*x(73);
r_53 = 3E-05*x(34)*x(61)*x(72);
r_54 = 0.001*x(33)*x(74);
r_55 = 0.001*x(60)*x(74);
r_56 = 3E-05*x(37)*x(58)*x(72);
r_57 = 0.001*x(36)*x(75);
r_58 = 0.001*x(57)*x(75);
r_59 = 3E-05*x(37)*x(61)*x(72);
r_60 = 0.001*x(36)*x(76);
r_61 = 0.001*x(60)*x(76);

% Assign derivatives
dsp_1 = -r_0 - r_15 - r_18;
dsp_2 = -r_0 - r_14 + r_16 - r_17 + r_19;
dsp_3 = r_0 + r_15 + r_18;
dsp_4 = -r_1 - r_21 - r_24;
dsp_5 = -r_1 - r_20 + r_22 - r_23 + r_25;
dsp_6 = r_1 + r_21 + r_24;
dsp_7 = -r_2 - r_6;
dsp_8 = -r_2 - r_4;
dsp_9 = r_2 + r_6;
dsp_10 = -r_3 - r_10;
dsp_11 = -r_3 - r_8;
dsp_12 = r_3 + r_10;
dsp_13 = -r_4 + r_7;
dsp_14 = r_4 - r_6;
dsp_15 = r_4 - r_14 + r_15 - r_20 + r_21;
dsp_16 = r_4 - r_5;
dsp_17 = -r_5 + r_38 + r_44;
dsp_18 = r_5 - r_7;
dsp_19 = r_5 - r_36 + r_37 - r_42 + r_43;
dsp_20 = r_6 - r_16 - r_22;
dsp_21 = -r_7 + r_16 + r_22;
dsp_22 = r_7 - r_38 - r_44;
dsp_23 = -r_8 + r_11;
dsp_24 = r_8 - r_10;
dsp_25 = r_8 - r_17 + r_18 - r_23 + r_24;
dsp_26 = r_8 - r_9;
dsp_27 = -r_9 + r_41 + r_47;
dsp_28 = r_9 - r_11;
dsp_29 = r_9 - r_39 + r_40 - r_45 + r_46;
dsp_30 = r_10 - r_19 - r_25;
dsp_31 = -r_11 + r_19 + r_25;
dsp_32 = r_11 - r_41 - r_47;
dsp_33 = -r_12 + r_15 + r_16 + r_18 + r_19 + r_21 + r_22 - r_51 - r_54;
dsp_34 = -r_12 + r_14 + r_17 + r_20 - r_50 + r_52 - r_53 + r_55;
dsp_35 = r_12 - r_14 - r_17 - r_20 + r_51 + r_54;
dsp_36 = -r_13 + r_24 + r_25 - r_57 - r_60;
dsp_37 = -r_13 + r_23 - r_56 + r_58 - r_59 + r_61;
dsp_38 = r_13 - r_23 + r_57 + r_60;
dsp_39 = r_14 - r_15 - r_16;
dsp_40 = r_17 - r_18 - r_19;
dsp_41 = r_20 - r_21 - r_22;
dsp_42 = r_23 - r_24 - r_25;
dsp_43 = -r_26 - r_31;
dsp_44 = -r_26 - r_30;
dsp_45 = r_26 + r_31;
dsp_46 = -r_27 - r_33;
dsp_47 = -r_27 - r_32;
dsp_48 = r_27 + r_33;
dsp_49 = -r_28 + r_33 - r_37 - r_40;
dsp_50 = -r_28 + r_32 - r_36 + r_38 - r_39 + r_41;
dsp_51 = r_28 - r_32 + r_37 + r_40;
dsp_52 = -r_29 + r_31 - r_43 - r_46;
dsp_53 = -r_29 + r_30 - r_42 + r_44 - r_45 + r_47;
dsp_54 = r_29 - r_30 + r_43 + r_46;
dsp_55 = r_30 - r_31;
dsp_56 = r_32 - r_33;
dsp_57 = -r_34 + r_37 + r_38 + r_40 + r_41 + r_43 + r_44 - r_52 - r_58;
dsp_58 = -r_34 + r_36 + r_39 + r_42 - r_50 + r_51 - r_56 + r_57;
dsp_59 = r_34 - r_36 - r_39 - r_42 + r_52 + r_58;
dsp_60 = -r_35 + r_46 + r_47 - r_55 - r_61;
dsp_61 = -r_35 + r_45 - r_53 + r_54 - r_59 + r_60;
dsp_62 = r_35 - r_45 + r_55 + r_61;
dsp_63 = r_36 - r_37 - r_38;
dsp_64 = r_39 - r_40 - r_41;
dsp_65 = r_42 - r_43 - r_44;
dsp_66 = r_45 - r_46 - r_47;
dsp_67 = -r_48 + r_51 + r_52;
dsp_68 = -r_48 + r_50;
dsp_69 = r_48 - r_50;
dsp_70 = -r_49 + r_54 + r_55 + r_57 + r_58 + r_60 + r_61;
dsp_71 = -r_49 + r_53 + r_56 + r_59;
dsp_72 = r_49 - r_53 - r_56 - r_59;
dsp_73 = r_50 - r_51 - r_52;
dsp_74 = r_53 - r_54 - r_55;
dsp_75 = r_56 - r_57 - r_58;
dsp_76 = r_59 - r_60 - r_61;


dxdt = [dsp_1; dsp_2; dsp_3; dsp_4; dsp_5; dsp_6; dsp_7; dsp_8; dsp_9; dsp_10; dsp_11; dsp_12; dsp_13; dsp_14; dsp_15; dsp_16; dsp_17; dsp_18; dsp_19; dsp_20; dsp_21; dsp_22; dsp_23; dsp_24; dsp_25; dsp_26; dsp_27; dsp_28; dsp_29; dsp_30; dsp_31; dsp_32; dsp_33; dsp_34; dsp_35; dsp_36; dsp_37; dsp_38; dsp_39; dsp_40; dsp_41; dsp_42; dsp_43; dsp_44; dsp_45; dsp_46; dsp_47; dsp_48; dsp_49; dsp_50; dsp_51; dsp_52; dsp_53; dsp_54; dsp_55; dsp_56; dsp_57; dsp_58; dsp_59; dsp_60; dsp_61; dsp_62; dsp_63; dsp_64; dsp_65; dsp_66; dsp_67; dsp_68; dsp_69; dsp_70; dsp_71; dsp_72; dsp_73; dsp_74; dsp_75; dsp_76];

return
endfunction
